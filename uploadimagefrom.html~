<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head> 
<title> Upload image via local file </title>
<link rel="stylesheet"
	href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.9.1.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css">
<style>
.datepicker {
	
}
</style>
<script>
	$(function() {
		$(".datepicker").datepicker({
			changeMonth : true,
			changeYear : true
		});
	});
</script>
</head>
<body> 
	<%@ page import="java.sql.*"%>

	<%!
		public Connection getConnection(String oracleId,String oraclePassword){
			Connection con = null;
			String driverName = "oracle.jdbc.driver.OracleDriver";
			String dbstring = "jdbc:oracle:thin:@wang8.cs.ualberta.ca:16270:CRS";
			try{
				Class drvClass = Class.forName(driverName);
				DriverManager.registerDriver((Driver)drvClass.newInstance());
				con=DriverManager.getConnection(dbstring,oracleId,oraclePassword);
				con.setAutoCommit(true);
			}
			catch(Exception e){
			
			}
			return con;
		}
	%>
	<%
		String userName=null;
		if(request.getParameter("UploadRecord") != null && ((String)session.getAttribute("class"))!=null){
			userName = (String)session.getAttribute("USERNAME");
		}
		else{
			response.sendRedirect("Login.html");
		}
     %>
	<H1>
		<CENTER>
			<font color=Teal>Please Enter the information needs to be
				upload: </font>
		</CENTER>
	</H1>
	<BR></BR>
	<BR></BR>
	<h4>Upload Image below
	</h4>
	Please input or select the path of the image!
	<FROM name="upload-image" method="POST" enctype="multipart/form-data" action="servlet/UploadImageLogicSQL">
		<TABLE style="margin: 0px auto">
		<!-- <TR>
				<TD><B><I><font color=Maroon>Choose Patient: </font></I></B></TD>
				<TD>
					<SELECT NAME='patientID'>
					<%
						Connection con=getConnection((String)session.getAttribute("ORACLE_ID"),(String)session.getAttribute("ORACLE_PASSWORD"));
						Statement s=con.createStatement();
						String sql="SELECT * FROM persons p WHERE p.person_id=ANY(SELECT u.person_id FROM users u WHERE u.class='p')";
						ResultSet resSet=s.executeQuery(sql);
						while(resSet.next()){
							Integer id=resSet.getInt("person_id");
							String fname=resSet.getString("first_name");
							String lname=resSet.getString("last_name");
							out.println("<OPTION VALUE='"+id+"' SELECTED> "+fname+" "+lname+" ID: "+id+" </OPTION>");
						}
					%>
					</SELECT>
				</TD>
			</TR> -->
			<TR>
				<TD><B><I><font color=Maroon>Share with: </font></I></B></TD>
				<TD>
					<SELECT NAME='sharedwith'>
					<%
						sql="SELECT * FROM persons p WHERE p.person_id=ANY(SELECT u.person_id FROM users u WHERE u.class='d')";
						resSet=s.executeQuery(sql);
						while(resSet.next()){
							Integer id=resSet.getInt("person_id");
							String fname=resSet.getString("first_name");
							String lname=resSet.getString("last_name");
							out.println("<OPTION VALUE='"+id+"' SELECTED> "+fname+" "+lname+" ID: "+id+" </OPTION>");
						}
						con.close();
					%>
					</SELECT>
				</TD>
			</TR>
		<!--	<TR>
				<TD><B><I><font color=Maroon>Test type: </font></I></B></TD>
				<TD><INPUT TYPE="text" NAME="    where the images were taken,
    when the images were taken,
    subject of the images,
    who shall be able to access the images.testType" VALUE=""></TD>
			</TR>-->
	
			<TR>
				<TD><B><I><font color=Maroon>Date photo was taken: 
								(MM-DD-YYYY): </font></I></B></TD>
				<TD><p>
						<INPUT TYPE="text" class="datepicker" NAME="tDate" VALUE="" />
					</p></TD>
			</TR>
			<TR>
				<TD><B><I><font color=Maroon>Location:  </font></I></B></TD>
				<TD><INPUT TYPE="text" NAME="diagnosis" VALUE=""></TD>
			</TR>
			<TR>
				<TD><B><I><font color=Maroon>Subject: </font></I></B></TD>
				<TD><INPUT TYPE="text" NAME="description" VALUE=""></TD>
			</TR>
		
  <tr>
    <th>File path: </th>
    <td><input name="file-path" type="file" size="30" ></input></td>
  </tr>
  <tr>
    <td ALIGN=CENTER COLSPAN="2"><input type="submit" name=".submit" 
     value="Upload"></td>
  </tr>

</table>


</html>

